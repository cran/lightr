<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Hugo Gruson" />

<meta name="date" content="2019-11-13" />

<title>Custom workflow using low-level parsers</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Custom workflow using low-level parsers</h1>
<h4 class="author">Hugo Gruson</h4>
<h4 class="date">2019-11-13</h4>



<p>Some use cases require more flexibility than the high-level user-friendly functions provides by <code>lightr</code>. For this use case, <code>lightr</code> also exports the low-level individual parsers, which allow the user to code its own custom workflow.</p>
<p>We don’t recommend the use of those functions unless you absolutely have to. Most users should use <code>lr_get_spec()</code> and <code>lr_get_metadata()</code> instead.</p>
<p>A common request from spectral data users is too keep their raw data, without any interpolation. This is not possible in <code>lr_get_spec()</code> but it parses spectra from many different formats and then concatenates them to output a single dataframe. For this to be possible, all spectra must be evaluated over the same wavelengths, which is not usually the case at first. So, we do need to interpolate them to make sure that they can safely be concatenated afterwards.</p>
<p>In this vignette, I described how you can import your spectral data without any interpolation in the case where you are working with only one file format, created from the same spectrometer and software.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(lightr)</a></code></pre></div>
<div id="step-1-find-all-files" class="section level2">
<h2>Step 1: find all files</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">jdx_files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">&quot;data/heliomaster&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;jdx$&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="step-2-import-individual-spectra" class="section level2">
<h2>Step 2: import individual spectra</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">first_jdx &lt;-<span class="st"> </span><span class="kw">lr_parse_jdx</span>(jdx_files[<span class="dv">1</span>])[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">head</span>(first_jdx)</a></code></pre></div>
<pre><code>##       wl      dark     white     scope  processed
## 1 176.36 32822.795 32822.795 32822.795        NaN
## 2 176.58 32822.795 32822.795 32822.795        NaN
## 3 176.80 32822.795 32822.795 32822.795        NaN
## 4 177.02  1611.751  1606.017  1643.290 -550.03488
## 5 177.24  1646.976  1555.227  1631.412   16.96367
## 6 177.47  2505.485  2494.426  2548.083 -385.18853</code></pre>
<p>As you can see on this first file, <code>lr_parse_$extension()</code> functions return a data frame with many columns. The meaning of each column is explained in full details in <code>?lr_parse_jdx</code>. Here, we are only interested in the first column (the wavelengths) and the last one (the normalised spectral data).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">res &lt;-<span class="st"> </span>first_jdx[, <span class="kw">c</span>(<span class="st">&quot;wl&quot;</span>, <span class="st">&quot;processed&quot;</span>)]</a></code></pre></div>
</div>
<div id="step-3-create-a-loop" class="section level2">
<h2>Step 3: create a loop</h2>
<p>We captured the wavelengths in the first spectra, we don’t need to save them each time because in this example, they are the same for all spectra. So we only record the “processed” column:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(jdx_files)) {</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  next_jdx &lt;-<span class="st"> </span><span class="kw">lr_parse_jdx</span>(jdx_files[i])[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  res &lt;-<span class="st"> </span><span class="kw">cbind</span>(res, next_jdx[, <span class="st">&quot;processed&quot;</span>])</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw">colnames</span>(res) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;wl&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;spec&quot;</span>, <span class="kw">seq_along</span>(jdx_files)))</a></code></pre></div>
<p>And it’s done, we can now convert <code>res</code> to an <code>rspec</code> object and use it in our analyses. The spectrometer I used for those measurements is not reliable outside the 300-700 nm wavelength range so we will only keep this range:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(pavo)</a></code></pre></div>
<pre><code>## Welcome to pavo 2! Take a look at the latest features (and update your bibliography) in our recent publication: Maia R., Gruson H., Endler J. A., White T. E. (2019) pavo 2: new tools for the spectral and spatial analysis of colour in R. Methods in Ecology and Evolution, 10, 1097-1107.</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">res &lt;-<span class="st"> </span><span class="kw">na.omit</span>(res)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">res &lt;-<span class="st"> </span>res[res<span class="op">$</span>wl <span class="op">&gt;</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>res<span class="op">$</span>wl <span class="op">&lt;</span><span class="st"> </span><span class="dv">700</span>, ]</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">res &lt;-<span class="st"> </span><span class="kw">as.rspec</span>(res, <span class="dt">interp =</span> <span class="ot">FALSE</span>, <span class="dt">whichwl =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## The spectral data contain 2 negative value(s), which may produce unexpected results if used in models. Consider using procspec() to correct them.</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">plot</span>(res)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="bonus-one-liner-with-the-tidyverse" class="section level2">
<h2>Bonus: one-liner with the tidyverse</h2>
<p>The following snippet should work for all file types supported by <code>lightr</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">library</span>(fs)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">get_uninterp &lt;-<span class="st"> </span><span class="cf">function</span>(path, extension) {</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">  <span class="kw">dir_ls</span>(<span class="dt">path =</span> path, <span class="dt">glob =</span> extension) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">    </span><span class="kw">map_dfc</span>(<span class="cf">function</span>(file) lightr<span class="op">:::</span><span class="kw">dispatch_parser</span>(file)[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">    </span><span class="kw">select</span>(wl, <span class="kw">starts_with</span>(<span class="st">&quot;processed&quot;</span>))</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="kw">get_uninterp</span>(<span class="st">&quot;data/heliomaster/&quot;</span>, <span class="dt">extension =</span> <span class="st">&quot;*.jdx&quot;</span>)</a></code></pre></div>
</div>
<div id="caveats" class="section level2">
<h2>Caveats</h2>
<p>The example presented in this example might be useful if you want to export your data in a human readable format, while retaining as much information as possible.</p>
<p><strong>But be careful if you intend to use this uninterpolated data in your analyses</strong>. Many statistics and models will produce bogus results when fed uninterpolated data.</p>
<p>One reason if because wavelengths are not always evenly distributed within the sampling range (they can result from a <a href="https://oceanoptics.com/wp-content/uploads/Spectrometer-Wavelength-Calibration-Instructions.pdf"><span class="math inline">\(3^{th}\)</span></a> to <span class="math inline">\(5^{th}\)</span> order polynome). Because of this, some regions of the wavelength range will be more heavily sampled than others, so statistics such a <span class="math inline">\(S1\)</span> (<code>summary.rspec()</code> in <code>pavo</code>) may not make any sense.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
